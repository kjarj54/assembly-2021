IMPRIME MACRO CADENA
	MOV AH, 09
	MOV DX, OFFSET CADENA
	INT 21H
ENDM

.MODEL SMALL

.STACK

.DATA
MSGTOTPAL DB 10D, 'CANTIDAD DE PALABRAS: ', '$', 10D
MSGTOTCARAC DB 'CANTIDAD DE LETRAS: ', '$', 10D
ARCHIVOMANEJADOR DW ?
NUM DW ?
LBK DB 13, 10, '$'
NUMSTR DB '$$$$$$$$'
ARCHIVO DB "C:\tarea.txt", 0
CADENACORREGIDA DB ?
VEC DB ?

.CODE

MOV AX, @DATA
MOV DS,AX

MOV DX, OFFSET ARCHIVO;

MOV AL, 2
MOV AH, 3DH
INT 21H

MOV ARCHIVOMANEJADOR, AX

LEA DX, VEC
MOV BX, ARCHIVOMANEJADOR  

MOV CX, 1000
MOV AH, 3FH
INT 21H


MOV BX, ARCHIVOMANEJADOR
MOV AH, 3EH
INT 21H

LEA SI, VEC
CALL ARCHIVOTEXTO

IMPRIME LBK
IMPRIME VEC
IMPRIME LBK

LEA SI, VEC
LEA DI, CADENACORREGIDA
CALL CORREGIRTEXTO

LEA SI, CADENACORREGIDA
CALL CONTPALABRA

LEA SI, CADENACORREGIDA

IMPRIME LBK

CALL CONTCARACTER

MOV AX, 4C02H
INT 21H

ARCHIVOTEXTO PROC
ATINICIO:
	MOV AL, [SI]
	CMP AL, 40H
	JE ATFIN
	INC SI
	JMP ATINICIO
ATFIN:
	MOV [SI], 24H
	RET
ARCHIVOTEXTO ENDP
    
CONTCARACTER PROC
	XOR CX, CX
CCINICIO:
	MOV AL, [SI]
	CMP AL, 24H
	JE CCFINAL
	CMP AL, 41H
	JNB CCA
	JMP CCOTRO
CCA:
	CMP AL, 5AH
	JBE CCZ
	CMP AL, 61H
	JNB CCAA
	JMP CCOTRO
CCAA:
	CMP AL, 7AH
	JBE CCZ
	JMP CCOTRO
CCZ:
	INC CX
	INC SI
	JMP CCINICIO
CCOTRO:
	INC SI
	JMP CCINICIO
CCFINAL:
	MOV NUM, CX
	MOV SI, OFFSET NUMSTR
	MOV AX, NUM
	CALL NUMEROASTRING
	IMPRIME MSGTOTCARAC
	IMPRIME NUMSTR
	IMPRIME LBK
	RET
CONTCARACTER ENDP

NUMEROASTRING PROC
	CALL SIGNO
	MOV BX, 10
	MOV CX, 0
CICLO1:
	MOV DX, 0
	DIV BX
	PUSH DX
	INC CX
	CMP AX, 0
	JNE CICLO1 
CICLO2:
	POP DX
	ADD DL, 48
	MOV [SI], DL
	INC SI
	LOOP CICLO2
	RET
NUMEROASTRING ENDP       

SIGNO PROC
  	MOV CX, 5
  	MOV DI, OFFSET NUMSTR
SIGNO_BUCLE:
  	MOV BL, '$'
  	MOV [DI], BL
  	INC DI
	LOOP SIGNO_BUCLE
  	RET
SIGNO ENDP

CONTPALABRA PROC
	XOR CX, CX
CPINICIO:
    MOV AL, [SI]
    CMP AL, 24H
    JE CPFINAL
	CMP AL, 20H
	JE CPESPEN
CPOTRO:
	INC SI
	JMP CPINICIO
CPESPEN:
	INC SI
	MOV AL, [SI]
	CMP AL, 20H
	JE CPINICIO
	CMP AL, 24H
	JE CPFINAL
	INC CX
	JMP CPINICIO
CPFINAL:
	IMPRIME MSGTOTPAL
	INC CX
	MOV NUM, CX
	MOV SI, OFFSET NUMSTR
    MOV AX, NUM
    CALL NUMEROASTRING
	IMPRIME NUMSTR
	IMPRIME LBK
	RET
CONTPALABRA ENDP


CORREGIRTEXTO PROC
	XOR CX, CX
CTINICIO:
    MOV AL, [SI]
    CMP AL, 24H
    JE CTFINAL
	CMP AL, 20H
	JE AGREGAR
	CMP AL, 0DH
	JE CTENTER
	CMP AL, 41H
	JNB CTA
	JMP CTOTRO
CTA:
	CMP AL, 5AH
	JBE AGREGAR
	CMP AL, 61H
	JNB CTZ
	JMP CTOTRO
CTZ:
	CMP AL, 7AH
	JBE AGREGAR
	JMP CTOTRO
CTOTRO:
	INC SI
	JMP CTINICIO
AGREGAR:
	MOV[DI], AL
	INC DI
	INC SI
	JMP CTINICIO
CTENTER:
	MOV [DI], 20H
	INC DI
	INC SI
	INC SI
	JMP CTINICIO
CTFINAL:
	MOV [DI], 24H
	RET
CORREGIRTEXTO ENDP
END