;Universidad nacional
;Estudiante: Kevin Arauz Jiminez
;Arquitectura de computaddoires
;Profesor: M.C. Gabriel Núñez M.

.MODEL SMALL
.STACK 100H

.DATA
	ARCHIVO DB "C:zonas\.txt", 0
	ARCHIVOMANEJADOR DW ?
	VEC DB ?
	LBK DB 13, 10, '$'
	MSGTOTAL DB 10D, 'CANTIDAD DE CANTONES: ', '$', 10D
	NUM DW ?
	NUMSTR DB '$$$$$$$$'

;Kevin Arauz Jiminez
IMPRIME MACRO CADENA
	MOV AH, 09
	MOV DX, OFFSET CADENA
	INT 21H
ENDM

.CODE

	MOV AX, @DATA
	MOV DS,AX

	MOV DX, OFFSET ARCHIVO

	MOV AL, 2H
	MOV AH, 3DH
	INT 21H

	MOV ARCHIVOMANEJADOR, AX

	LEA DX, VEC
	MOV BX, ARCHIVOMANEJADOR  

	MOV CX, 1000
	MOV AH, 3FH
	INT 21H


	MOV BX, ARCHIVOMANEJADOR
	MOV AH, 3EH
	INT 21H

	LEA SI, VEC
	CALL ARCHIVOTEXTO

	IMPRIME LBK
	IMPRIME VEC
	IMPRIME LBK

	LEA SI, VEC

	CALL CONTCANTON

	IMPRIME LBK

	MOV AX, 4C02H
	INT 21H

ARCHIVOTEXTO PROC
ATINICIO:
	MOV AL, [SI]
	CMP AL, 25H
	JE ATFIN
	INC SI
	JMP ATINICIO
ATFIN:
	MOV [SI], 24H
	RET
ARCHIVOTEXTO ENDP


NUMEROASTRING PROC
	CALL SIGNO
	MOV BX, 10
	MOV CX, 0
CICLO1:
	MOV DX, 0
	DIV BX
	PUSH DX
	INC CX
	CMP AX, 0
	JNE CICLO1 
CICLO2:
	POP DX
	ADD DL, 48
	MOV [SI], DL
	INC SI
	LOOP CICLO2
	RET
NUMEROASTRING ENDP       

SIGNO PROC
  	MOV CX, 5
  	MOV DI, OFFSET NUMSTR
SIGNO_BUCLE:
  	MOV BL, '$'
  	MOV [DI], BL
  	INC DI
	LOOP SIGNO_BUCLE
  	RET
SIGNO ENDP

CONTCANTON PROC
	XOR CX, CX
CPINICIO:
    MOV AL, [SI]
    CMP AL, 24H
    JE CPFINAL
	CMP AL, 26H
	JE CPESPEN
CPOTRO:
	INC SI
	JMP CPINICIO
CPESPEN:
	INC SI
	MOV AL, [SI]
	CMP AL, 26H
	JE CPINICIO
	CMP AL, 24H
	JE CPFINAL
	INC CX
	JMP CPINICIO
CPFINAL:
	IMPRIME MSGTOTAL
	INC CX
	MOV NUM, CX
	MOV SI, OFFSET NUMSTR
    MOV AX, NUM
    CALL NUMEROASTRING
	IMPRIME NUMSTR
	IMPRIME LBK
	RET
CONTCANTON ENDP


END
;Kevin Arauz Jiminez